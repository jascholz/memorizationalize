.united--admin

  .united--notifications{ 'auto-refresh': edit_game_united_path }
    .refresh-content
      = render 'shared/admin_notifications'

      .united--admin-box
        - users = User.where("updated_at > ?", 10.seconds.ago).select { |user| user.role != 'admin' }
        %h3.united--text Online: #{users.count}
        = users.join(', ')

      - if @game.polling?
        .united--admin-box
          %h3.united--text Votes: #{@votes.count}

.united--admin-contols
  .content--body
    %h1= @game.name

    - if @game.pending?
      = form_for @game, url: update_game_united_path  do |f|
        = f.hidden_field :state_event, value: 'start'
        = f.submit 'Start Game'

    - elsif @game.polling?
      = form_for @game, url: update_game_united_path  do |f|
        = f.hidden_field :state_event, value: 'finish_poll'
        = f.submit 'Finish Poll'

    - elsif @game.poll_results?
      - if @game.polls.pending.any?
        = form_for @game, url: update_game_united_path  do |f|
          = f.hidden_field :state_event, value: 'next_poll'
          = f.submit 'Next Poll'
      - else
        No more questions available

      = form_for @game, url: update_game_united_path  do |f|
        = f.hidden_field :state_event, value: 'finish'
        = f.submit 'Finish Game'

    - elsif @game.finished?
      = form_for @game, url: update_game_united_path  do |f|
        = f.hidden_field :state_event, value: 'end'
        = f.submit 'End Game'
